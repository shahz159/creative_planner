<!-- For  New Subtask  -->
<div class="kt-portlet">
    <div class="kt-portlet__head">
        <div class="offcanvas-header d-flex align-items-center justify-content-between flex-1">
            <h4 class="m-0">Action To Project</h4>
            <a href="javascript:void(0)" class="btn btn-icon btn-hover-info" (click)="closeInfo()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"
                    fill="currentColor">
                    <path fill="none" d="M0 0h24v24H0z" />
                    <path
                        d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z" />
                </svg>
            </a>
        </div>
    </div>
    <div class="kt-portlet__body pb-0 pt-3 sidehf_scroll scroll-y">

    <h5 class="pro-nm text-info mb-2">{{_MainPrjectName}}</h5>
    <div class="form-group" [hidden]="ProjectsDropdownBoolean">
        <label>Select Project :<span class="text-danger">*</span></label>
        <!-- <ng-multiselect-dropdown required [placeholder]="'Select Project'" [settings]="dropdownSettings_Projects"
            [data]="_ProjectDataList" [(ngModel)]="selectedProjectCodelist" (onSelect)="ProjectOnSelect($event)"
            (onDeSelect)="ProjectOnDeselect($event)" > -->
            <!-- (onFilterChange)="onFilterChange($event)"> -->
        <!-- </ng-multiselect-dropdown> -->
        <ng-select reuired #action="ngModel" (change)="ProjectOnSelect()" [(ngModel)]="selectedProjectCodelist" placeholder="Select project" >
            <ng-option [value]="item.Project_Code" *ngFor="let item of _ProjectDataList">
                {{item.Project_Name }}
            </ng-option>
        </ng-select>
        <span *ngIf ="_projcode == true" style="color:red">Project required!</span>
    </div>
    <div class="form-group">
        <label> Action Name <span class="text-danger">*</span></label>
        <input #name="ngModel" required type="text" class="form-control" placeholder="Enter action name" [(ngModel)]="Sub_ProjectName" required />
        <span *ngIf ="_subname == true" style="color:red">Action Name required!</span>
    </div>
    <div class="form-group">
        <label>Description :<span class="text-danger">*</span></label>
        <textarea #description="ngModel" required class="form-control" placeholder="Enter action description" [(ngModel)]="_Description" style="height: 100px"></textarea>
        <span *ngIf ="_desbool == true" style="color:red">Description required!</span>
    </div>
    <!-- <div class="form-group">
        <label> Assign To <span class="text-danger">*</span> : <strong></strong></label>
        <ng-multiselect-dropdown [placeholder]="'Select Employee'" [settings]="dropdownSettings_EMP"
            [data]="_EmployeeListForDropdown" [(ngModel)]="selected_Employee" (onSelect)="EmployeeOnSelect($event)"
            (onDeSelect)="EmployeeOnDeselect($event)">

        </ng-multiselect-dropdown>
    </div> -->
    <div class="form-group text-dark-50 w-75px flex-grow-1 brdng-0">
        <label> Assign To <span class="text-danger">*</span> : <strong></strong></label>
        <!-- <ng-select reuired #assign="ngModel" (Change)="EmployeeOnSelect($event)" [(ngModel)]="selectedEmpNo" placeholder="Select employee" >
            <ng-option [value]="item.Emp_No" [disabled]="item.Emp_No==Owner_Empno" *ngFor="let item of _EmployeeListForDropdown">
                {{item.DisplayName}}
            </ng-option>
        </ng-select> -->
        <ng-select [items]="allUsers" bindLabel="RACIS"
            bindValue="Emp_No" groupBy="usergroup"
            (change)="EmployeeOnSelect($event)" placeholder="Select employee"
            [searchable]="true" name="RACIS"
            [(ngModel)]="selectedEmpNo" 
            required>
            <!-- <ng-template ng-option-tmp let-item="item">
                <ng-container *ngIf="item.Emp_No === Owner_Empno"> 
                  <ng-option [value]="item.Emp_No">
                    <p  >{{ item.RACIS }} </p>
                </ng-option>
                </ng-container>
                <ng-container *ngIf="item.Emp_No !== Owner_Empno">
                  <ng-option [value]="item.Emp_No">{{ item.RACIS }}</ng-option>
                </ng-container>
              </ng-template> -->

              <ng-template ng-option-tmp let-item="item">
                <span [ngClass]="{'disabled-option': item.Emp_No === Owner_Empno }">
                  {{ item.RACIS }}
                </span>
              </ng-template>
        </ng-select>
        <span *ngIf ="_selectemp == true" style="color:red">Assign To required!</span>
    </div>
    <div class="form-group text-dark-50 w-75px flex-grow-1 brdng-0">
        <label>Action Owner : <strong></strong></label>
        <ng-select reuired #ownerno="ngModel" [(ngModel)]="owner" placeholder="Select owner" >
            <ng-option [value]="item.Emp_No" *ngFor="let item of ownerArr" [disabled]="item.Emp_No==selectedEmpNo" >
                <span>{{item.RACIS}}</span> 
            </ng-option>
        </ng-select>
    </div>
    <div class="d-flex gap-1">
        <div class="form-group flex-1">
            <label>Start Date : <span class="text-danger">*</span></label>
            <div class="input-group" (click)="startdatechecker()">
                <input matInput [matDatepicker]="picker1" required #startdate="ngModel" (click)="picker1.open()" [min]="disablePreviousDate"
                    [(ngModel)]="_StartDate" placeholder="Start date" class="form-control">
                   
                <div class="input-group-text p-0">
                    <mat-datepicker-toggle matSuffix [for]="picker1" ></mat-datepicker-toggle>
                    <mat-datepicker #picker1 ></mat-datepicker>
                </div>
            </div>
            <span *ngIf ="_sdate == true" style="color:red">Start Date required!</span>
        </div>
        <div class="form-group flex-1" *ngIf="_StartDate!=null">
            <label>End Date :<span class="text-danger">*</span></label>
            <div class="input-group">
                <input matInput [matDatepicker]="picker2" required #Enddate="ngModel" (click)="picker2.open()" [min]="_StartDate"
                    [(ngModel)]="_EndDate" placeholder="End date" class="form-control">
                <div class="input-group-text p-0">
                    <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                    <mat-datepicker #picker2></mat-datepicker>
                </div>
            </div>
            <span *ngIf ="_edate == true" style="color:red">End Date required!</span>
        </div>
        <div class="form-group flex-1" *ngIf="_StartDate==null">
            <label>End Date :<span class="text-danger">*</span></label>
            <div class="input-group" (click)="enddateChecker()">
                <input matInput [matDatepicker]="picker2"  [matDatepickerFilter]="myFilter"
                required #Enddate="ngModel" (click)="picker2.open()" 
                    [(ngModel)]="_EndDate" placeholder="End Date" class="form-control">
                <div class="input-group-text p-0">
                    <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                    <mat-datepicker #picker2></mat-datepicker>
                </div>
            </div>
        </div>
    </div>

    <div class="form-group">
        <label>Allocated Hours<span class="text-danger" *ngIf="selectedEmpNo == Current_user_ID">*</span></label>
        <!-- [ngClass]="{'form-control':maxlimit==true,'form-control-danger':maxlimit==false}" -->
        <input id="hour-input" #allocated="ngModel" required type="number" class="form-control" placeholder="Enter action duration in hrs" [(ngModel)]="_allocated" min="0" oninput="validity.valid||(value='');"
            (click)="alertMaxAllocation()">
        <span *ngIf="selectedEmpNo == Current_user_ID && allocated.touched && allocated.invalid" style="color:red">Allocated hours required!</span>
        <span *ngIf="_allocated > maxAllocation" style="color:red">*Allocation per day limit is 10 hours.</span>
        <span *ngIf="_allocated > maxAllocation" style="color:red">Please enter the hours less than or equal to <b>{{maxAllocation}}</b> hours!</span>
        <span *ngIf="(_allocated==0)" style="color:red">*Allocated hours cannot be 0, please enter a value.</span>
        <span *ngIf="this._StartDate == null || this._EndDate == null" style="color:red">{{_message}}</span>
    </div>
    
    <div class="form-group">
        <label for="exampleFormControlFile1">Remarks</label>
        <textarea class="form-control" aria-label="With textarea" placeholder="Enter action remarks if any" [(ngModel)]="_remarks"
            style="height: 111px;"></textarea>
    </div>

    <div class="form-group">
        <div class="custom-file pl-1">
            <input type="file" class="form-control-file" id="uploadFile"
                (change)="onFileChange($event)"/>
        </div>
    </div>
    </div>
    <div class="kt-portlet__foot py-3">
        
        <div class="form-group mb-0">
            <button type="submit" class="btn btn-info btn-sm"  (click)="sweetAlert()" *ngIf="selectedEmpNo == Current_user_ID"
                [disabled]="!Sub_ProjectName || !_Description || !selectedEmpNo || !_StartDate || !_EndDate || !_allocated || (_allocated > maxAllocation)">Submit
            </button>
            <button type="submit" class="btn  btn-info btn-sm"  (click)="sweetAlert()" *ngIf="selectedEmpNo != Current_user_ID"
                [disabled]="!Sub_ProjectName || !_Description || !selectedEmpNo || !_StartDate || !_EndDate || (_allocated > maxAllocation)">Submit
            </button>
            <!-- <button type="submit" class="btn btn-primary"  (click)="sweetAlert()" *ngIf="selectedEmpNo != Current_user_ID"
                >Submit
            </button> -->
            <button type="submit" class="btn btn-secondary btn-sm ml-2"  (click)="closeInfo()">close</button>
        </div>
    </div>
</div>