!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("@tweenjs/tween.js")):"function"==typeof define&&define.amd?define("ngx-virtual-scroller",["exports","@angular/core","@angular/common","@tweenjs/tween.js"],t):t((e=e||self)["ngx-virtual-scroller"]={},e.ng.core,e.ng.common,e.TWEEN)}(this,(function(e,t,i,r){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function n(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s}function o(e,t){return function(i,r){t(i,r,e)}}function s(){return{checkResizeInterval:1e3,modifyOverflowStyleOfParentScroll:!0,resizeBypassRefreshThreshold:5,scrollAnimationTime:750,scrollDebounceTime:0,scrollThrottlingTime:0,stripedTable:!1}}var l=function(){function e(e,r,n,o,s,l){this.element=e,this.renderer=r,this.zone=n,this.changeDetectorRef=o,this.window=window,this.executeRefreshOutsideAngularZone=!1,this._enableUnequalChildrenSizes=!1,this.RTL=!1,this.useMarginInsteadOfTranslate=!1,this.ssrViewportWidth=1920,this.ssrViewportHeight=1080,this._items=[],this.compareItems=function(e,t){return e===t},this.vsUpdate=new t.EventEmitter,this.vsChange=new t.EventEmitter,this.vsStart=new t.EventEmitter,this.vsEnd=new t.EventEmitter,this.calculatedScrollbarWidth=0,this.calculatedScrollbarHeight=0,this.padding=0,this.previousViewPort={},this.cachedPageSize=0,this.previousScrollNumberElements=0,this.isAngularUniversalSSR=i.isPlatformServer(s),this.checkResizeInterval=l.checkResizeInterval,this.modifyOverflowStyleOfParentScroll=l.modifyOverflowStyleOfParentScroll,this.resizeBypassRefreshThreshold=l.resizeBypassRefreshThreshold,this.scrollAnimationTime=l.scrollAnimationTime,this.scrollDebounceTime=l.scrollDebounceTime,this.scrollThrottlingTime=l.scrollThrottlingTime,this.scrollbarHeight=l.scrollbarHeight,this.scrollbarWidth=l.scrollbarWidth,this.stripedTable=l.stripedTable,this.horizontal=!1,this.resetWrapGroupDimensions()}return Object.defineProperty(e.prototype,"viewPortInfo",{get:function(){var e=this.previousViewPort||{};return{startIndex:e.startIndex||0,endIndex:e.endIndex||0,scrollStartPosition:e.scrollStartPosition||0,scrollEndPosition:e.scrollEndPosition||0,maxScrollPosition:e.maxScrollPosition||0,startIndexWithBuffer:e.startIndexWithBuffer||0,endIndexWithBuffer:e.endIndexWithBuffer||0}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableUnequalChildrenSizes",{get:function(){return this._enableUnequalChildrenSizes},set:function(e){this._enableUnequalChildrenSizes!==e&&(this._enableUnequalChildrenSizes=e,this.minMeasuredChildWidth=void 0,this.minMeasuredChildHeight=void 0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferAmount",{get:function(){return"number"==typeof this._bufferAmount&&this._bufferAmount>=0?this._bufferAmount:this.enableUnequalChildrenSizes?5:0},set:function(e){this._bufferAmount=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollThrottlingTime",{get:function(){return this._scrollThrottlingTime},set:function(e){this._scrollThrottlingTime=e,this.updateOnScrollFunction()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollDebounceTime",{get:function(){return this._scrollDebounceTime},set:function(e){this._scrollDebounceTime=e,this.updateOnScrollFunction()},enumerable:!0,configurable:!0}),e.prototype.updateOnScrollFunction=function(){var e=this;this.scrollDebounceTime?this.onScroll=this.debounce((function(){e.refresh_internal(!1)}),this.scrollDebounceTime):this.scrollThrottlingTime?this.onScroll=this.throttleTrailing((function(){e.refresh_internal(!1)}),this.scrollThrottlingTime):this.onScroll=function(){e.refresh_internal(!1)}},Object.defineProperty(e.prototype,"checkResizeInterval",{get:function(){return this._checkResizeInterval},set:function(e){this._checkResizeInterval!==e&&(this._checkResizeInterval=e,this.addScrollEventHandlers())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},set:function(e){e!==this._items&&(this._items=e||[],this.refresh_internal(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontal",{get:function(){return this._horizontal},set:function(e){this._horizontal=e,this.updateDirection()},enumerable:!0,configurable:!0}),e.prototype.revertParentOverscroll=function(){var e=this.getScrollElement();e&&this.oldParentScrollOverflow&&(e.style["overflow-y"]=this.oldParentScrollOverflow.y,e.style["overflow-x"]=this.oldParentScrollOverflow.x),this.oldParentScrollOverflow=void 0},Object.defineProperty(e.prototype,"parentScroll",{get:function(){return this._parentScroll},set:function(e){if(this._parentScroll!==e){this.revertParentOverscroll(),this._parentScroll=e,this.addScrollEventHandlers();var t=this.getScrollElement();this.modifyOverflowStyleOfParentScroll&&t!==this.element.nativeElement&&(this.oldParentScrollOverflow={x:t.style["overflow-x"],y:t.style["overflow-y"]},t.style["overflow-y"]=this.horizontal?"visible":"auto",t.style["overflow-x"]=this.horizontal?"auto":"visible")}},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.addScrollEventHandlers()},e.prototype.ngOnDestroy=function(){this.removeScrollEventHandlers(),this.revertParentOverscroll()},e.prototype.ngOnChanges=function(e){var t=this.cachedItemsLength!==this.items.length;this.cachedItemsLength=this.items.length;var i=!e.items||!e.items.previousValue||0===e.items.previousValue.length;this.refresh_internal(t||i)},e.prototype.ngDoCheck=function(){if(this.cachedItemsLength!==this.items.length)return this.cachedItemsLength=this.items.length,void this.refresh_internal(!0);if(this.previousViewPort&&this.viewPortItems&&this.viewPortItems.length>0){for(var e=!1,t=0;t<this.viewPortItems.length;++t)if(!this.compareItems(this.items[this.previousViewPort.startIndexWithBuffer+t],this.viewPortItems[t])){e=!0;break}e&&this.refresh_internal(!0)}},e.prototype.refresh=function(){this.refresh_internal(!0)},e.prototype.invalidateAllCachedMeasurements=function(){this.wrapGroupDimensions={maxChildSizePerWrapGroup:[],numberOfKnownWrapGroupChildSizes:0,sumOfKnownWrapGroupChildWidths:0,sumOfKnownWrapGroupChildHeights:0},this.minMeasuredChildWidth=void 0,this.minMeasuredChildHeight=void 0,this.refresh_internal(!1)},e.prototype.invalidateCachedMeasurementForItem=function(e){if(this.enableUnequalChildrenSizes){var t=this.items&&this.items.indexOf(e);t>=0&&this.invalidateCachedMeasurementAtIndex(t)}else this.minMeasuredChildWidth=void 0,this.minMeasuredChildHeight=void 0;this.refresh_internal(!1)},e.prototype.invalidateCachedMeasurementAtIndex=function(e){if(this.enableUnequalChildrenSizes){var t=this.wrapGroupDimensions.maxChildSizePerWrapGroup[e];t&&(this.wrapGroupDimensions.maxChildSizePerWrapGroup[e]=void 0,--this.wrapGroupDimensions.numberOfKnownWrapGroupChildSizes,this.wrapGroupDimensions.sumOfKnownWrapGroupChildWidths-=t.childWidth||0,this.wrapGroupDimensions.sumOfKnownWrapGroupChildHeights-=t.childHeight||0)}else this.minMeasuredChildWidth=void 0,this.minMeasuredChildHeight=void 0;this.refresh_internal(!1)},e.prototype.scrollInto=function(e,t,i,r,n){void 0===t&&(t=!0),void 0===i&&(i=0),void 0===r&&(r=void 0),void 0===n&&(n=void 0);var o=this.items.indexOf(e);-1!==o&&this.scrollToIndex(o,t,i,r,n)},e.prototype.scrollToIndex=function(e,t,i,r,n){var o=this;void 0===t&&(t=!0),void 0===i&&(i=0),void 0===r&&(r=void 0),void 0===n&&(n=void 0);var s=5,l=function(){if(--s<=0)n&&n();else{var r=o.calculateDimensions(),a=Math.min(Math.max(e,0),r.itemCount-1);o.previousViewPort.startIndex!==a?o.scrollToIndex_internal(e,t,i,0,l):n&&n()}};this.scrollToIndex_internal(e,t,i,r,l)},e.prototype.scrollToIndex_internal=function(e,t,i,r,n){void 0===t&&(t=!0),void 0===i&&(i=0),void 0===r&&(r=void 0),void 0===n&&(n=void 0),r=void 0===r?this.scrollAnimationTime:r;var o=this.calculateDimensions(),s=this.calculatePadding(e,o)+i;t||(s-=o.wrapGroupsPerPage*o[this._childScrollDim]),this.scrollToPosition(s,r,n)},e.prototype.scrollToPosition=function(e,t,i){var n=this;void 0===t&&(t=void 0),void 0===i&&(i=void 0),e+=this.getElementsOffset(),t=void 0===t?this.scrollAnimationTime:t;var o,s=this.getScrollElement();if(this.currentTween&&(this.currentTween.stop(),this.currentTween=void 0),!t)return this.renderer.setProperty(s,this._scrollType,e),void this.refresh_internal(!1,i);var l={scrollPosition:s[this._scrollType]},a=new r.Tween(l).to({scrollPosition:e},t).easing(r.Easing.Quadratic.Out).onUpdate((function(e){isNaN(e.scrollPosition)||(n.renderer.setProperty(s,n._scrollType,e.scrollPosition),n.refresh_internal(!1))})).onStop((function(){cancelAnimationFrame(o)})).start(),h=function(t){a.isPlaying()&&(a.update(t),l.scrollPosition!==e?n.zone.runOutsideAngular((function(){o=requestAnimationFrame(h)})):n.refresh_internal(!1,i))};h(),this.currentTween=a},e.prototype.getElementSize=function(e){var t=e.getBoundingClientRect(),i=getComputedStyle(e),r=parseInt(i["margin-top"],10)||0,n=parseInt(i["margin-bottom"],10)||0,o=parseInt(i["margin-left"],10)||0,s=parseInt(i["margin-right"],10)||0;return{top:t.top+r,bottom:t.bottom+n,left:t.left+o,right:t.right+s,width:t.width+o+s,height:t.height+r+n}},e.prototype.checkScrollElementResized=function(){var e,t=this.getElementSize(this.getScrollElement());if(this.previousScrollBoundingRect){var i=Math.abs(t.width-this.previousScrollBoundingRect.width),r=Math.abs(t.height-this.previousScrollBoundingRect.height);e=i>this.resizeBypassRefreshThreshold||r>this.resizeBypassRefreshThreshold}else e=!0;e&&(this.previousScrollBoundingRect=t,t.width>0&&t.height>0&&this.refresh_internal(!1))},e.prototype.updateDirection=function(){this.horizontal?(this._childScrollDim="childWidth",this._invisiblePaddingProperty="scaleX",this._marginDir="margin-left",this._offsetType="offsetLeft",this._pageOffsetType="pageXOffset",this._scrollType="scrollLeft",this._translateDir="translateX"):(this._childScrollDim="childHeight",this._invisiblePaddingProperty="scaleY",this._marginDir="margin-top",this._offsetType="offsetTop",this._pageOffsetType="pageYOffset",this._scrollType="scrollTop",this._translateDir="translateY")},e.prototype.debounce=function(e,t){var i=this.throttleTrailing(e,t),r=function(){i.cancel(),i.apply(this,arguments)};return r.cancel=function(){i.cancel()},r},e.prototype.throttleTrailing=function(e,t){var i=void 0,r=arguments,n=function(){var n=this;r=arguments,i||(t<=0?e.apply(n,r):i=setTimeout((function(){i=void 0,e.apply(n,r)}),t))};return n.cancel=function(){i&&(clearTimeout(i),i=void 0)},n},e.prototype.refresh_internal=function(e,t,i){var r=this;if(void 0===t&&(t=void 0),void 0===i&&(i=2),e&&this.previousViewPort&&this.previousViewPort.scrollStartPosition>0){var n=this.previousViewPort,o=this.viewPortItems,s=t;t=function(){var e=r.previousViewPort.scrollLength-n.scrollLength;if(e>0&&r.viewPortItems){var t=o[0],i=r.items.findIndex((function(e){return r.compareItems(t,e)}));if(i>r.previousViewPort.startIndexWithBuffer){for(var l=!1,a=1;a<r.viewPortItems.length;++a)if(!r.compareItems(r.items[i+a],o[a])){l=!0;break}if(!l)return void r.scrollToPosition(r.previousViewPort.scrollStartPosition+e,0,s)}}s&&s()}}this.zone.runOutsideAngular((function(){requestAnimationFrame((function(){e&&r.resetWrapGroupDimensions();var n=r.calculateViewport(),o=e||n.startIndex!==r.previousViewPort.startIndex,s=e||n.endIndex!==r.previousViewPort.endIndex,l=n.scrollLength!==r.previousViewPort.scrollLength,a=n.padding!==r.previousViewPort.padding,h=n.scrollStartPosition!==r.previousViewPort.scrollStartPosition||n.scrollEndPosition!==r.previousViewPort.scrollEndPosition||n.maxScrollPosition!==r.previousViewPort.maxScrollPosition;if(r.previousViewPort=n,l&&(r.renderer.setStyle(r.invisiblePaddingElementRef.nativeElement,"transform",r._invisiblePaddingProperty+"("+n.scrollLength+")"),r.renderer.setStyle(r.invisiblePaddingElementRef.nativeElement,"webkitTransform",r._invisiblePaddingProperty+"("+n.scrollLength+")")),a&&(r.useMarginInsteadOfTranslate?r.renderer.setStyle(r.contentElementRef.nativeElement,r._marginDir,n.padding+"px"):(r.renderer.setStyle(r.contentElementRef.nativeElement,"transform",r._translateDir+"("+n.padding+"px)"),r.renderer.setStyle(r.contentElementRef.nativeElement,"webkitTransform",r._translateDir+"("+n.padding+"px)"))),r.headerElementRef){var c=r.getScrollElement()[r._scrollType],d=r.getElementsOffset(),p=Math.max(c-n.padding-d+r.headerElementRef.nativeElement.clientHeight,0);r.renderer.setStyle(r.headerElementRef.nativeElement,"transform",r._translateDir+"("+p+"px)"),r.renderer.setStyle(r.headerElementRef.nativeElement,"webkitTransform",r._translateDir+"("+p+"px)")}var u=o||s?{startIndex:n.startIndex,endIndex:n.endIndex,scrollStartPosition:n.scrollStartPosition,scrollEndPosition:n.scrollEndPosition,startIndexWithBuffer:n.startIndexWithBuffer,endIndexWithBuffer:n.endIndexWithBuffer,maxScrollPosition:n.maxScrollPosition}:void 0;if(o||s||h){var f=function(){r.viewPortItems=n.startIndexWithBuffer>=0&&n.endIndexWithBuffer>=0?r.items.slice(n.startIndexWithBuffer,n.endIndexWithBuffer+1):[],r.vsUpdate.emit(r.viewPortItems),o&&r.vsStart.emit(u),s&&r.vsEnd.emit(u),(o||s)&&(r.changeDetectorRef.markForCheck(),r.vsChange.emit(u)),i>0?r.refresh_internal(!1,t,i-1):t&&t()};r.executeRefreshOutsideAngularZone?f():r.zone.run(f)}else{if(i>0&&(l||a))return void r.refresh_internal(!1,t,i-1);t&&t()}}))}))},e.prototype.getScrollElement=function(){return this.parentScroll instanceof Window?document.scrollingElement||document.documentElement||document.body:this.parentScroll||this.element.nativeElement},e.prototype.addScrollEventHandlers=function(){var e=this;if(!this.isAngularUniversalSSR){var t=this.getScrollElement();this.removeScrollEventHandlers(),this.zone.runOutsideAngular((function(){e.parentScroll instanceof Window?(e.disposeScrollHandler=e.renderer.listen("window","scroll",e.onScroll),e.disposeResizeHandler=e.renderer.listen("window","resize",e.onScroll)):(e.disposeScrollHandler=e.renderer.listen(t,"scroll",e.onScroll),e._checkResizeInterval>0&&(e.checkScrollElementResizedTimer=setInterval((function(){e.checkScrollElementResized()}),e._checkResizeInterval)))}))}},e.prototype.removeScrollEventHandlers=function(){this.checkScrollElementResizedTimer&&clearInterval(this.checkScrollElementResizedTimer),this.disposeScrollHandler&&(this.disposeScrollHandler(),this.disposeScrollHandler=void 0),this.disposeResizeHandler&&(this.disposeResizeHandler(),this.disposeResizeHandler=void 0)},e.prototype.getElementsOffset=function(){if(this.isAngularUniversalSSR)return 0;var e=0;if(this.containerElementRef&&this.containerElementRef.nativeElement&&(e+=this.containerElementRef.nativeElement[this._offsetType]),this.parentScroll){var t=this.getScrollElement(),i=this.getElementSize(this.element.nativeElement),r=this.getElementSize(t);this.horizontal?e+=i.left-r.left:e+=i.top-r.top,this.parentScroll instanceof Window||(e+=t[this._scrollType])}return e},e.prototype.countItemsPerWrapGroup=function(){if(this.isAngularUniversalSSR)return Math.round(this.horizontal?this.ssrViewportHeight/this.ssrChildHeight:this.ssrViewportWidth/this.ssrChildWidth);var e=this.horizontal?"offsetLeft":"offsetTop",t=(this.containerElementRef&&this.containerElementRef.nativeElement||this.contentElementRef.nativeElement).children,i=t?t.length:0;if(0===i)return 1;for(var r=t[0][e],n=1;n<i&&r===t[n][e];)++n;return n},e.prototype.getScrollStartPosition=function(){var e=void 0;return this.parentScroll instanceof Window&&(e=window[this._pageOffsetType]),e||this.getScrollElement()[this._scrollType]||0},e.prototype.resetWrapGroupDimensions=function(){var e=this.wrapGroupDimensions;if(this.invalidateAllCachedMeasurements(),this.enableUnequalChildrenSizes&&e&&0!==e.numberOfKnownWrapGroupChildSizes)for(var t=this.countItemsPerWrapGroup(),i=0;i<e.maxChildSizePerWrapGroup.length;++i){var r=e.maxChildSizePerWrapGroup[i];if(r&&r.items&&r.items.length){if(r.items.length!==t)return;for(var n=!1,o=t*i,s=0;s<t;++s)if(!this.compareItems(r.items[s],this.items[o+s])){n=!0;break}n||(++this.wrapGroupDimensions.numberOfKnownWrapGroupChildSizes,this.wrapGroupDimensions.sumOfKnownWrapGroupChildWidths+=r.childWidth||0,this.wrapGroupDimensions.sumOfKnownWrapGroupChildHeights+=r.childHeight||0,this.wrapGroupDimensions.maxChildSizePerWrapGroup[i]=r)}}},e.prototype.calculateDimensions=function(){var e=this.getScrollElement();this.calculatedScrollbarHeight=Math.max(Math.min(e.offsetHeight-e.clientHeight,25),this.calculatedScrollbarHeight),this.calculatedScrollbarWidth=Math.max(Math.min(e.offsetWidth-e.clientWidth,25),this.calculatedScrollbarWidth);var t,i,r,n=e.offsetWidth-(this.scrollbarWidth||this.calculatedScrollbarWidth||(this.horizontal?0:25)),o=e.offsetHeight-(this.scrollbarHeight||this.calculatedScrollbarHeight||(this.horizontal?25:0)),s=this.containerElementRef&&this.containerElementRef.nativeElement||this.contentElementRef.nativeElement,l=this.countItemsPerWrapGroup();if(this.isAngularUniversalSSR){n=this.ssrViewportWidth,o=this.ssrViewportHeight,i=this.ssrChildWidth,r=this.ssrChildHeight;var a=Math.max(Math.ceil(n/i),1),h=Math.max(Math.ceil(o/r),1);t=this.horizontal?a:h}else if(this.enableUnequalChildrenSizes){var c=e[this._scrollType]-(this.previousViewPort?this.previousViewPort.padding:0),d=this.previousViewPort.startIndexWithBuffer||0,p=Math.ceil(d/l),u=0,f=0,m=0,v=0;t=0;for(var g=0;g<s.children.length;++g){++d;W=s.children[g],C=this.getElementSize(W);if(u=Math.max(u,C.width),f=Math.max(f,C.height),d%l==0){var S=this.wrapGroupDimensions.maxChildSizePerWrapGroup[p];S&&(--this.wrapGroupDimensions.numberOfKnownWrapGroupChildSizes,this.wrapGroupDimensions.sumOfKnownWrapGroupChildWidths-=S.childWidth||0,this.wrapGroupDimensions.sumOfKnownWrapGroupChildHeights-=S.childHeight||0),++this.wrapGroupDimensions.numberOfKnownWrapGroupChildSizes;var y=this.items.slice(d-l,d);if(this.wrapGroupDimensions.maxChildSizePerWrapGroup[p]={childWidth:u,childHeight:f,items:y},this.wrapGroupDimensions.sumOfKnownWrapGroupChildWidths+=u,this.wrapGroupDimensions.sumOfKnownWrapGroupChildHeights+=f,this.horizontal){var w=Math.min(u,Math.max(n-m,0));if(c>0)w-=P=Math.min(c,w),c-=P;m+=w,w>0&&n>=m&&++t}else{var P,b=Math.min(f,Math.max(o-v,0));if(c>0)b-=P=Math.min(c,b),c-=P;v+=b,b>0&&o>=v&&++t}++p,u=0,f=0}}var I=this.wrapGroupDimensions.sumOfKnownWrapGroupChildWidths/this.wrapGroupDimensions.numberOfKnownWrapGroupChildSizes,x=this.wrapGroupDimensions.sumOfKnownWrapGroupChildHeights/this.wrapGroupDimensions.numberOfKnownWrapGroupChildSizes;i=this.childWidth||I||n,r=this.childHeight||x||o,this.horizontal?n>m&&(t+=Math.ceil((n-m)/i)):o>v&&(t+=Math.ceil((o-v)/r))}else{if(s.children.length>0){this.childWidth&&this.childHeight||(!this.minMeasuredChildWidth&&n>0&&(this.minMeasuredChildWidth=n),!this.minMeasuredChildHeight&&o>0&&(this.minMeasuredChildHeight=o));var W=s.children[0],C=this.getElementSize(W);this.minMeasuredChildWidth=Math.min(this.minMeasuredChildWidth,C.width),this.minMeasuredChildHeight=Math.min(this.minMeasuredChildHeight,C.height)}i=this.childWidth||this.minMeasuredChildWidth||n,r=this.childHeight||this.minMeasuredChildHeight||o;a=Math.max(Math.ceil(n/i),1),h=Math.max(Math.ceil(o/r),1);t=this.horizontal?a:h}var E=this.items.length,z=l*t,T=E/z,_=Math.ceil(E/l),O=0,M=this.horizontal?i:r;if(this.enableUnequalChildrenSizes){var R=0;for(g=0;g<_;++g){var G=this.wrapGroupDimensions.maxChildSizePerWrapGroup[g]&&this.wrapGroupDimensions.maxChildSizePerWrapGroup[g][this._childScrollDim];G?O+=G:++R}O+=Math.round(R*M)}else O=_*M;this.headerElementRef&&(O+=this.headerElementRef.nativeElement.clientHeight);var D=this.horizontal?n:o;return{childHeight:r,childWidth:i,itemCount:E,itemsPerPage:z,itemsPerWrapGroup:l,maxScrollPosition:Math.max(O-D,0),pageCount_fractional:T,scrollLength:O,viewportLength:D,wrapGroupsPerPage:t}},e.prototype.calculatePadding=function(e,t){if(0===t.itemCount)return 0;var i=t[this._childScrollDim],r=Math.floor(e/t.itemsPerWrapGroup)||0;if(!this.enableUnequalChildrenSizes)return i*r;for(var n=0,o=0,s=0;s<r;++s){var l=this.wrapGroupDimensions.maxChildSizePerWrapGroup[s]&&this.wrapGroupDimensions.maxChildSizePerWrapGroup[s][this._childScrollDim];l?o+=l:++n}return o+=Math.round(n*i)},e.prototype.calculatePageInfo=function(e,t){var i=0;if(this.enableUnequalChildrenSizes)for(var r=Math.ceil(t.itemCount/t.itemsPerWrapGroup),n=0,o=t[this._childScrollDim],s=0;s<r;++s){var l=this.wrapGroupDimensions.maxChildSizePerWrapGroup[s]&&this.wrapGroupDimensions.maxChildSizePerWrapGroup[s][this._childScrollDim];if(e<(n+=l||o)){i=s/r;break}}else i=e/t.scrollLength;var a=Math.min(Math.max(i*t.pageCount_fractional,0),t.pageCount_fractional)*t.itemsPerPage,h=t.itemCount-t.itemsPerPage-1,c=Math.min(Math.floor(a),h);if(c-=c%t.itemsPerWrapGroup,this.stripedTable){var d=2*t.itemsPerWrapGroup;c%d!=0&&(c=Math.max(c-c%d,0))}var p=Math.ceil(a)+t.itemsPerPage-1,u=(p+1)%t.itemsPerWrapGroup;u>0&&(p+=t.itemsPerWrapGroup-u),isNaN(c)&&(c=0),isNaN(p)&&(p=0),c=Math.min(Math.max(c,0),t.itemCount-1),p=Math.min(Math.max(p,0),t.itemCount-1);var f=this.bufferAmount*t.itemsPerWrapGroup;return{startIndex:c,endIndex:p,startIndexWithBuffer:Math.min(Math.max(c-f,0),t.itemCount-1),endIndexWithBuffer:Math.min(Math.max(p+f,0),t.itemCount-1),scrollStartPosition:e,scrollEndPosition:e+t.viewportLength,maxScrollPosition:t.maxScrollPosition}},e.prototype.calculateViewport=function(){var e=this.calculateDimensions(),t=this.getElementsOffset(),i=this.getScrollStartPosition();i>e.scrollLength+t&&!(this.parentScroll instanceof Window)?i=e.scrollLength:i-=t,i=Math.max(0,i);var r=this.calculatePageInfo(i,e),n=this.calculatePadding(r.startIndexWithBuffer,e),o=e.scrollLength;return{startIndex:r.startIndex,endIndex:r.endIndex,startIndexWithBuffer:r.startIndexWithBuffer,endIndexWithBuffer:r.endIndexWithBuffer,padding:Math.round(n),scrollLength:Math.round(o),scrollStartPosition:r.scrollStartPosition,scrollEndPosition:r.scrollEndPosition,maxScrollPosition:r.maxScrollPosition}},e.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer2},{type:t.NgZone},{type:t.ChangeDetectorRef},{type:Object,decorators:[{type:t.Inject,args:[t.PLATFORM_ID]}]},{type:void 0,decorators:[{type:t.Optional},{type:t.Inject,args:["virtual-scroller-default-options"]}]}]},n([t.Input()],e.prototype,"executeRefreshOutsideAngularZone",void 0),n([t.Input()],e.prototype,"enableUnequalChildrenSizes",null),n([t.Input()],e.prototype,"RTL",void 0),n([t.Input()],e.prototype,"useMarginInsteadOfTranslate",void 0),n([t.Input()],e.prototype,"modifyOverflowStyleOfParentScroll",void 0),n([t.Input()],e.prototype,"stripedTable",void 0),n([t.Input()],e.prototype,"scrollbarWidth",void 0),n([t.Input()],e.prototype,"scrollbarHeight",void 0),n([t.Input()],e.prototype,"childWidth",void 0),n([t.Input()],e.prototype,"childHeight",void 0),n([t.Input()],e.prototype,"ssrChildWidth",void 0),n([t.Input()],e.prototype,"ssrChildHeight",void 0),n([t.Input()],e.prototype,"ssrViewportWidth",void 0),n([t.Input()],e.prototype,"ssrViewportHeight",void 0),n([t.Input()],e.prototype,"bufferAmount",null),n([t.Input()],e.prototype,"scrollAnimationTime",void 0),n([t.Input()],e.prototype,"resizeBypassRefreshThreshold",void 0),n([t.Input()],e.prototype,"scrollThrottlingTime",null),n([t.Input()],e.prototype,"scrollDebounceTime",null),n([t.Input()],e.prototype,"checkResizeInterval",null),n([t.Input()],e.prototype,"items",null),n([t.Input()],e.prototype,"compareItems",void 0),n([t.Input()],e.prototype,"horizontal",null),n([t.Input()],e.prototype,"parentScroll",null),n([t.Output()],e.prototype,"vsUpdate",void 0),n([t.Output()],e.prototype,"vsChange",void 0),n([t.Output()],e.prototype,"vsStart",void 0),n([t.Output()],e.prototype,"vsEnd",void 0),n([t.ViewChild("content",{read:t.ElementRef,static:!0})],e.prototype,"contentElementRef",void 0),n([t.ViewChild("invisiblePadding",{read:t.ElementRef,static:!0})],e.prototype,"invisiblePaddingElementRef",void 0),n([t.ContentChild("header",{read:t.ElementRef,static:!1})],e.prototype,"headerElementRef",void 0),n([t.ContentChild("container",{read:t.ElementRef,static:!1})],e.prototype,"containerElementRef",void 0),e=n([t.Component({selector:"virtual-scroller,[virtualScroller]",exportAs:"virtualScroller",template:'\n    <div class="total-padding" #invisiblePadding></div>\n    <div class="scrollable-content" #content>\n      <ng-content></ng-content>\n    </div>\n  ',host:{"[class.horizontal]":"horizontal","[class.vertical]":"!horizontal","[class.selfScroll]":"!parentScroll","[class.rtl]":"RTL"},styles:["\n    :host {\n      position: relative;\n\t  \tdisplay: block;\n      -webkit-overflow-scrolling: touch;\n    }\n\n\t\t:host.horizontal.selfScroll {\n      overflow-y: visible;\n      overflow-x: auto;\n\t\t}\n\n\t\t:host.horizontal.selfScroll.rtl {\n\t\t\ttransform: scaleX(-1);\n\t\t}\n\n\t\t:host.vertical.selfScroll {\n      overflow-y: auto;\n      overflow-x: visible;\n\t\t}\n\n    .scrollable-content {\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      max-width: 100vw;\n      max-height: 100vh;\n      position: absolute;\n    }\n\n\t\t.scrollable-content ::ng-deep > * {\n\t\t\tbox-sizing: border-box;\n\t\t}\n\n\t\t:host.horizontal {\n\t\t\twhite-space: nowrap;\n\t\t}\n\n\t\t:host.horizontal .scrollable-content {\n\t\t\tdisplay: flex;\n\t\t}\n\n\t\t:host.horizontal .scrollable-content ::ng-deep > * {\n\t\t\tflex-shrink: 0;\n\t\t\tflex-grow: 0;\n\t\t\twhite-space: initial;\n\t\t}\n\n\t\t:host.horizontal.rtl .scrollable-content ::ng-deep > * {\n\t\t\ttransform:scaleX(-1);\n\t\t}\n\n    .total-padding {\n      position: absolute;\n      top: 0;\n      left: 0;\n      height: 1px;\n      width: 1px;\n      transform-origin: 0 0;\n      opacity: 0;\n    }\n\n    :host.horizontal .total-padding {\n      height: 100%;\n    }\n  "]}),o(4,t.Inject(t.PLATFORM_ID)),o(5,t.Optional()),o(5,t.Inject("virtual-scroller-default-options"))],e)}(),a=function(){function e(){}return e=n([t.NgModule({exports:[l],declarations:[l],imports:[i.CommonModule],providers:[{provide:"virtual-scroller-default-options",useFactory:s}]})],e)}();e.VIRTUAL_SCROLLER_DEFAULT_OPTIONS_FACTORY=s,e.VirtualScrollerComponent=l,e.VirtualScrollerModule=a,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-virtual-scroller.umd.min.js.map