(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{hmWn:function(e,t,c){"use strict";c.r(t),c.d(t,"ActionToProjectModule",(function(){return X}));var n=c("ofXK"),i=c("3Pt+"),o=c("tyNb"),s=c("ZE33"),a=c("Eu0l"),r=c("PSD3"),l=c.n(r),d=c("fXoL"),u=c("ps0H"),b=c("tHiJ"),h=c("0IaG"),p=c("FKr1"),m=c("6i5P"),g=c("Cj0y"),_=c("EFnj"),D=c("Egam"),f=c("ZOsW"),j=c("iadO");function S(e,t){1&e&&(d.cc(0,"span",38),d.Xc(1,"Project required!"),d.bc())}function C(e,t){1&e&&(d.cc(0,"span",38),d.Xc(1,"Action Name required!"),d.bc())}function P(e,t){1&e&&(d.cc(0,"span",38),d.Xc(1,"Description required!"),d.bc())}function y(e,t){if(1&e&&(d.cc(0,"ng-option",39),d.Xc(1),d.bc()),2&e){const e=t.$implicit;d.yc("value",e.Emp_No),d.Jb(1),d.Zc(" ",e.DisplayName," ")}}function k(e,t){1&e&&(d.cc(0,"span",38),d.Xc(1,"Assign To required!"),d.bc())}function T(e,t){1&e&&(d.cc(0,"span",38),d.Xc(1,"Start Date required!"),d.bc())}function O(e,t){1&e&&(d.cc(0,"span",38),d.Xc(1,"End Date required!"),d.bc())}function v(e,t){1&e&&(d.cc(0,"span",8),d.Xc(1,"*"),d.bc())}function E(e,t){1&e&&(d.cc(0,"span",38),d.Xc(1,"Allocated hours required!"),d.bc())}function M(e,t){1&e&&(d.cc(0,"span",38),d.Xc(1,"*Allocation per day limit is 10 hours."),d.bc())}function w(e,t){if(1&e&&(d.cc(0,"span",38),d.Xc(1,"Please enter the hours less than or equal to "),d.cc(2,"b"),d.Xc(3),d.bc(),d.Xc(4," hours!"),d.bc()),2&e){const e=d.rc();d.Jb(3),d.Yc(e.maxAllocation)}}function A(e,t){if(1&e&&(d.cc(0,"span",38),d.Xc(1),d.bc()),2&e){const e=d.rc();d.Jb(1),d.Yc(e._message)}}function N(e,t){if(1&e){const e=d.dc();d.cc(0,"button",40),d.nc("click",(function(){return d.Mc(e),d.rc().sweetAlert()})),d.Xc(1,"Submit "),d.bc()}if(2&e){const e=d.rc();d.yc("disabled",!(e.selectedProjectCodelist&&e.Sub_ProjectName&&e._Description&&e.selected_Employee&&e._StartDate&&e._EndDate&&e._allocated&&!(e._allocated>e.maxAllocation)))}}function I(e,t){if(1&e){const e=d.dc();d.cc(0,"button",40),d.nc("click",(function(){return d.Mc(e),d.rc().sweetAlert()})),d.Xc(1,"Submit "),d.bc()}if(2&e){const e=d.rc();d.yc("disabled",!e.selectedProjectCodelist||!e.Sub_ProjectName||!e._Description||!e.selected_Employee||!e._StartDate||!e._EndDate||e._allocated>e.maxAllocation)}}const J=[{path:"",component:(()=>{class e{constructor(e,t,c,n,i,o,r,l,d){this.notifyService=e,this.ProjectTypeService=t,this.router=c,this.dialog=n,this.dateAdapter=i,this.BsService=o,this.service=r,this._projectunplanned=l,this._Todoproject=d,this._inputAttachments=[],this.selectedEmpNo="",this._MainPrjectName="",this.dropdownSettings_EMP={},this.disablePreviousDate=new Date,this.task_id=null,this.ProjectsDropdownBoolean=!1,this._MasterCode=null,this.ProjectBlock=null,this.selectedFile=null,this.dropdownSettings_Projects={},this._EmployeeListForDropdown=[],this.selectedProjectCodelist=[],this.selected_Employee=[],this.maxlimit=!0,this.CurrentUser_ID=localStorage.getItem("EmpNo"),this.ObjSubTaskDTO=new s.a,this.ObjUserDetails=new a.a,this.disablePreviousDate.setDate(this.disablePreviousDate.getDate()),this.BsService.bs_projectCode.subscribe(e=>{null==e?(this.ProjectsDropdownBoolean=!1,this.GetProjectsByUserName(),this._MasterCode=null):(this._MasterCode=e,this.ProjectsDropdownBoolean=!0,this.selectedProjectCode=e,this.service.GetDeadlineByProjectCode(this.selectedProjectCode).subscribe(e=>{this.ProjectDeadLineDate=e.DeadLine}))}),this.BsService.bs_ProjectName.subscribe(e=>this._MainPrjectName=e),this.BsService.bs_AssignId.subscribe(e=>this.task_id=e),this.BsService.bs_TaskName.subscribe(e=>{this.Sub_ProjectName=e}),this._inputAttachments=[]}ngOnInit(){this.Current_user_ID=localStorage.getItem("EmpNo"),this.GetAllEmployeesForAssignDropdown()}GetAllEmployeesForAssignDropdown(){this.service._GetCompletedProjects({pagenumber:1,Emp_No:this.CurrentUser_ID,Mode:"AssignedTask"}).subscribe(e=>{this._EmployeeListForDropdown=JSON.parse(e[0].EmployeeList),this.dropdownSettings_EMP={searchAutofocus:!0,singleSelection:!0,idField:"Emp_No",textField:"DisplayName",itemsShowLimit:2,closeDropDownOnSelection:!0,allowSearchFilter:!0}})}onFilterChange(e){this.filterText=e,this.GetProjectsByUserName()}ProjectOnSelect(e){this.selectedProjectCode=e.Project_Code,this.service.GetDeadlineByProjectCode(this.selectedProjectCode).subscribe(e=>{this.ProjectDeadLineDate=e.DeadLine})}ProjectOnDeselect(e){this.selectedProjectCode=""}GetProjectsByUserName(){this.ObjUserDetails.PageNumber=1,this.ObjUserDetails.PageSize=30,this.ObjUserDetails.SearchText=this.filterText,this.service.GetProjectsForRunwayTaskDropdown(this.ObjUserDetails).subscribe(e=>{this._ProjectDataList=JSON.parse(e[0].DropdownProjects_Json),this.dropdownSettings_Projects={singleSelection:!0,idField:"Project_Code",textField:"Project_Name",itemsShowLimit:1,allowSearchFilter:!0,closeDropDownOnSelection:!0,clearSearchFilter:!0,searchPlaceholderText:"Search by project name",maxHeight:"500px",allowRemoteDataSearch:!0,noDataAvailablePlaceholderText:"Please wait.."}})}onFileChange(e){this._inputAttachments=[...this._inputAttachments,{FileName:e.target.files[0].name,Size:e.target.files[0].size,Files:e.target.files[0]}]}EmployeeOnSelect(e){this.selectedEmpNo=e}EmployeeOnDeselect(e){this.selectedEmpNo=null}alertMaxAllocation(){if(null==this._StartDate||null==this._EndDate)this._message="Start Date/End date missing!!";else{var e=this._StartDate.getTime()-this._EndDate.getTime();this.maxAllocation=-e/864e5*10/1}}OnSubmit(){null==this._MasterCode?(this.ObjSubTaskDTO.MasterCode=this.selectedProjectCode,this._MasterCode=this.selectedProjectCode):this.ObjSubTaskDTO.MasterCode=this._MasterCode,this.service._GetNewProjectCode(this.ObjSubTaskDTO).subscribe(e=>{this.Sub_ProjectCode=e.SubTask_ProjectCode,this.EmpNo_Autho=e.Team_Autho,this.ProjectBlock=e.ProjectBlock,null!=this.task_id?this.ObjSubTaskDTO.AssignId=this.task_id:this.task_id=0,this.ObjSubTaskDTO.SubProject_Name=this.Sub_ProjectName,this.ObjSubTaskDTO.SubtaskDescription=this._Description,this.ObjSubTaskDTO.ProjectBlock=this.ProjectBlock,this.ObjSubTaskDTO.StartDate=this._StartDate,this.ObjSubTaskDTO.SubProject_DeadLine=this._EndDate,this.maxAllocation=8*this.maxAllocation/1,this.ObjSubTaskDTO.Emp_No=this.CurrentUser_ID,this.ObjSubTaskDTO.AssignTo=this.selectedEmpNo,this.ObjSubTaskDTO.Remarks=this._remarks,this.ObjSubTaskDTO.Duration=this._allocated,this._inputAttachments.length>0&&(this.ObjSubTaskDTO.Attachments=this._inputAttachments[0].Files);var t=new Date(this._StartDate).toUTCString(),c=new Date(this._EndDate).toUTCString();const n=new FormData;n.append("Project_Code",this.Sub_ProjectCode),n.append("Team_Autho",this.EmpNo_Autho),this._inputAttachments.length>0?(n.append("Attachment","true"),n.append("file",this._inputAttachments[0].Files)):(n.append("Attachment","false"),n.append("file","")),n.append("_MasterCode",this.ObjSubTaskDTO.MasterCode),n.append("SubtaskName",this.Sub_ProjectName),n.append("Desc",this._Description),n.append("Projectblock",this.ProjectBlock),n.append("StartDate",t),n.append("EndDate",c),n.append("Emp_No",this.CurrentUser_ID),n.append("AssignTo",this.selectedEmpNo),n.append("Remarks",this._remarks),n.append("EmployeeName",localStorage.getItem("UserfullName")),n.append("AssignId",this.task_id.toString()),null!=this.ObjSubTaskDTO.Duration?n.append("Duration",this.ObjSubTaskDTO.Duration.toString()):this.ObjSubTaskDTO.Duration=0,this.service._InsertNewSubtask(n).subscribe(e=>{this.notifyService.showInfo("Created Successfully","Action"),this._Todoproject.CallOnSubmitAction(),this._projectunplanned.CallOnSubmitCategory(),this.Clear_Feilds(),this.closeInfo(),this._inputAttachments=[]}),setTimeout(this._projectunplanned.CallOnSubmitCategory,3e3),setTimeout((function(){this.loadsubcateg()}),3e3),this._projectunplanned.CallOnSubmitCategory(),setTimeout(this._Todoproject.CallOnSubmitAction,3e3),setTimeout((function(){this.loadsubcateg()}),3e3),this._Todoproject.CallOnSubmitAction()})}sweetAlert(){new Date(this._EndDate).toUTCString(),new Date(this.ProjectDeadLineDate).toUTCString();const e=new Date(this._EndDate);new Date(this.ProjectDeadLineDate)<=e?l.a.fire({title:"Action DeadLine is Greater then Main Project DeadLine ?",text:"Do you Want to Continue For Selection Of Date After Main Project DeadLine!!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No"}).then(e=>{e.value?this.OnSubmit():e.dismiss===l.a.DismissReason.cancel&&l.a.fire("Cancelled","Action is Not Created","error")}):this.OnSubmit()}closeInfo(){this.Clear_Feilds(),document.getElementById("mysideInfobar").style.width="0",document.getElementById("rightbar-overlay").style.display="none",document.getElementsByClassName("side_view")[0].classList.remove("position-fixed"),document.getElementById("mysideInfobar1").style.width="0"}Clear_Feilds(){this.Sub_ProjectCode="",this.Sub_ProjectName="",this._Description="",this._StartDate=null,this._EndDate=null,this._remarks="",this._allocated=0,this._inputAttachments=[],this._inputAttachments2=[],this.selectedEmpNo="",this.selected_Employee=[],this.selectedProjectCodelist=[],document.getElementById("uploadFile").value=""}}return e.\u0275fac=function(t){return new(t||e)(d.Wb(u.a),d.Wb(b.a),d.Wb(o.f),d.Wb(h.b),d.Wb(p.c),d.Wb(m.a),d.Wb(b.a),d.Wb(g.a),d.Wb(_.a))},e.\u0275cmp=d.Qb({type:e,selectors:[["app-action-to-project"]],decls:89,vars:36,consts:[["id","mysideInfobar_NewSubtask",1,"sideInfobar","animate-right","offcanvas"],[1,"p-4"],[1,"offcanvas-header","d-flex","align-items-center","justify-content-between","pb-2","mb-3","brdr-b"],["href","javascript:void(0)",1,"btn","btn-sm","btn-icon","btn-hover-primary","closebtn",3,"click"],[1,"fa","fa-times"],[1,"font-weight-bold","m-0"],[1,"pro-nm","text-info","mb-2"],[1,"form-group",3,"hidden"],[1,"text-danger"],["required","",3,"formControl","placeholder","settings","data","ngModel","ngModelChange","onSelect","onDeSelect","onFilterChange"],["style","color:red",4,"ngIf"],[1,"form-group"],["required","","type","text","required","",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],["required","",1,"form-control",2,"height","139px",3,"ngModel","ngModelChange"],["description","ngModel"],[1,"form-group","text-dark-50","w-75px","flex-grow-1","brdng-0"],["reuired","","placeholder","Select Employee",3,"ngModel","Change","ngModelChange"],["assign","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"input-group"],["matInput","","required","","placeholder","Start Date",1,"form-control",3,"matDatepicker","min","ngModel","click","ngModelChange"],["startdate","ngModel"],[1,"input-group-text","p-0"],["matSuffix","",3,"for"],["picker1",""],["matInput","","required","","placeholder","End Date",1,"form-control",3,"matDatepicker","min","ngModel","click","ngModelChange"],["Enddate","ngModel"],["picker2",""],["class","text-danger",4,"ngIf"],["required","","type","number","min","0","oninput","validity.valid||(value='');",1,"form-control",3,"ngModel","ngModelChange","click"],["allocated","ngModel"],["for","exampleFormControlFile1"],["aria-label","With textarea",1,"form-control",2,"height","111px",3,"ngModel","ngModelChange"],[1,"custom-file","pl-1"],["type","file","id","uploadFile","accept","application/pdf",1,"form-control-file",3,"change"],[1,"form-group","mb-1"],["type","submit","class","btn btn-primary",3,"disabled","click",4,"ngIf"],[2,"color","red"],[3,"value"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){if(1&e){const e=d.dc();d.cc(0,"div",0),d.cc(1,"div",1),d.cc(2,"div",2),d.cc(3,"a",3),d.nc("click",(function(){return t.closeInfo()})),d.Xb(4,"i",4),d.bc(),d.cc(5,"h3",5),d.Xc(6,"Action To Project"),d.bc(),d.bc(),d.cc(7,"h5",6),d.Xc(8),d.bc(),d.cc(9,"div",7),d.cc(10,"label"),d.Xc(11,"Select Project :"),d.cc(12,"span",8),d.Xc(13,"*"),d.bc(),d.bc(),d.cc(14,"ng-multiselect-dropdown",9),d.nc("ngModelChange",(function(e){return t.selectedProjectCodelist=e}))("onSelect",(function(e){return t.ProjectOnSelect(e)}))("onDeSelect",(function(e){return t.ProjectOnDeselect(e)}))("onFilterChange",(function(e){return t.onFilterChange(e)})),d.bc(),d.Vc(15,S,2,0,"span",10),d.bc(),d.cc(16,"div",11),d.cc(17,"label"),d.Xc(18," Action Name "),d.cc(19,"span",8),d.Xc(20,"*"),d.bc(),d.bc(),d.cc(21,"input",12,13),d.nc("ngModelChange",(function(e){return t.Sub_ProjectName=e})),d.bc(),d.Vc(23,C,2,0,"span",10),d.bc(),d.cc(24,"div",11),d.cc(25,"label"),d.Xc(26,"Description :"),d.cc(27,"span",8),d.Xc(28,"*"),d.bc(),d.bc(),d.cc(29,"textarea",14,15),d.nc("ngModelChange",(function(e){return t._Description=e})),d.bc(),d.Vc(31,P,2,0,"span",10),d.bc(),d.cc(32,"div",16),d.cc(33,"label"),d.Xc(34," Assign To "),d.cc(35,"span",8),d.Xc(36,"*"),d.bc(),d.Xc(37," : "),d.Xb(38,"strong"),d.bc(),d.cc(39,"ng-select",17,18),d.nc("Change",(function(e){return t.EmployeeOnSelect(e)}))("ngModelChange",(function(e){return t.selectedEmpNo=e})),d.Vc(41,y,2,2,"ng-option",19),d.bc(),d.Vc(42,k,2,0,"span",10),d.bc(),d.cc(43,"div",11),d.cc(44,"label"),d.Xc(45,"Start Date : "),d.cc(46,"span",8),d.Xc(47,"*"),d.bc(),d.bc(),d.cc(48,"div",20),d.cc(49,"input",21,22),d.nc("click",(function(){return d.Mc(e),d.Jc(54).open()}))("ngModelChange",(function(e){return t._StartDate=e})),d.bc(),d.cc(51,"div",23),d.Xb(52,"mat-datepicker-toggle",24),d.Xb(53,"mat-datepicker",null,25),d.bc(),d.bc(),d.Vc(55,T,2,0,"span",10),d.bc(),d.cc(56,"div",11),d.cc(57,"label"),d.Xc(58,"End Date :"),d.cc(59,"span",8),d.Xc(60,"*"),d.bc(),d.bc(),d.cc(61,"div",20),d.cc(62,"input",26,27),d.nc("click",(function(){return d.Mc(e),d.Jc(67).open()}))("ngModelChange",(function(e){return t._EndDate=e})),d.bc(),d.cc(64,"div",23),d.Xb(65,"mat-datepicker-toggle",24),d.Xb(66,"mat-datepicker",null,28),d.bc(),d.bc(),d.Vc(68,O,2,0,"span",10),d.bc(),d.cc(69,"div",11),d.cc(70,"label"),d.Xc(71,"Allocated Hours"),d.Vc(72,v,2,0,"span",29),d.bc(),d.cc(73,"input",30,31),d.nc("ngModelChange",(function(e){return t._allocated=e}))("click",(function(){return t.alertMaxAllocation()})),d.bc(),d.Vc(75,E,2,0,"span",10),d.Vc(76,M,2,0,"span",10),d.Vc(77,w,5,1,"span",10),d.Vc(78,A,2,1,"span",10),d.bc(),d.cc(79,"div",11),d.cc(80,"label",32),d.Xc(81,"Remarks"),d.bc(),d.cc(82,"textarea",33),d.nc("ngModelChange",(function(e){return t._remarks=e})),d.bc(),d.bc(),d.cc(83,"div",11),d.cc(84,"div",34),d.cc(85,"input",35),d.nc("change",(function(e){return t.onFileChange(e)})),d.bc(),d.bc(),d.bc(),d.cc(86,"div",36),d.Vc(87,N,2,1,"button",37),d.Vc(88,I,2,1,"button",37),d.bc(),d.bc(),d.bc()}if(2&e){const e=d.Jc(22),c=d.Jc(30),n=d.Jc(40),i=d.Jc(50),o=d.Jc(54),s=d.Jc(63),a=d.Jc(67),r=d.Jc(74);d.Jb(8),d.Yc(t._MainPrjectName),d.Jb(1),d.yc("hidden",t.ProjectsDropdownBoolean),d.Jb(5),d.Ob("is-invalid",e.required&&e.touched),d.yc("formControl",e)("placeholder","Select Project")("settings",t.dropdownSettings_Projects)("data",t._ProjectDataList)("ngModel",t.selectedProjectCodelist),d.Jb(1),d.yc("ngIf",e.required&&e.touched),d.Jb(6),d.yc("ngModel",t.Sub_ProjectName),d.Jb(2),d.yc("ngIf",e.touched&&e.invalid),d.Jb(6),d.yc("ngModel",t._Description),d.Jb(2),d.yc("ngIf",c.touched&&c.invalid),d.Jb(8),d.yc("ngModel",t.selectedEmpNo),d.Jb(2),d.yc("ngForOf",t._EmployeeListForDropdown),d.Jb(1),d.yc("ngIf",n.touched&&!t.selectedEmpNo),d.Jb(7),d.yc("matDatepicker",o)("min",t.disablePreviousDate)("ngModel",t._StartDate),d.Jb(3),d.yc("for",o),d.Jb(3),d.yc("ngIf",i.touched&&i.invalid),d.Jb(7),d.yc("matDatepicker",a)("min",t.disablePreviousDate)("ngModel",t._EndDate),d.Jb(3),d.yc("for",a),d.Jb(3),d.yc("ngIf",s.touched&&s.invalid),d.Jb(4),d.yc("ngIf",t.selectedEmpNo==t.Current_user_ID),d.Jb(1),d.yc("ngModel",t._allocated),d.Jb(2),d.yc("ngIf",t.selectedEmpNo==t.Current_user_ID&&r.touched&&r.invalid),d.Jb(1),d.yc("ngIf",t._allocated>t.maxAllocation),d.Jb(1),d.yc("ngIf",t._allocated>t.maxAllocation),d.Jb(1),d.yc("ngIf",null==t._StartDate||null==t._EndDate),d.Jb(4),d.yc("ngModel",t._remarks),d.Jb(5),d.yc("ngIf",t.selectedEmpNo==t.Current_user_ID),d.Jb(1),d.yc("ngIf",t.selectedEmpNo!=t.Current_user_ID)}},directives:[D.a,i.w,i.o,i.g,n.o,i.d,i.r,f.a,n.n,j.b,j.d,j.a,i.t,f.c],styles:["input[_ngcontent-%COMP%]::-webkit-inner-spin-button, input[_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"]}),e})()}];let x=(()=>{class e{}return e.\u0275mod=d.Ub({type:e}),e.\u0275inj=d.Tb({factory:function(t){return new(t||e)},imports:[[o.i.forChild(J)],o.i]}),e})(),X=(()=>{class e{}return e.\u0275mod=d.Ub({type:e}),e.\u0275inj=d.Tb({factory:function(t){return new(t||e)},providers:[u.a],imports:[[n.c,x,D.b,i.k,i.v,j.c,f.b]]}),e})()}}]);